<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>VANTAGE Software: VANTAGE</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="AstorTheOcelot.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VANTAGE Software
   &#160;<span id="projectnumber">4.20</span>
   </div>
   <div id="projectbrief">Taking Pictures of CubeSats</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>General Comments</h2>
<p>This codebase is based around the test types used for the 2018-2019 development cycle. These included three types:</p><ol type="1">
<li>Simulation Testing The simulation test was created using a combination of Cinema4D and Blensor, for the purpose of simulation the optical and TOF cameras, respectively. This suite (<a href="https://github.com/vantagecu/VANTAGE_Simulation">VANTAGE_Simulation</a>) can be found in the <a href="https://github.com/vantagecu">VANTAGE organization</a> repo. The truth data for this test is generated by the Cinema4D program itself.</li>
<li>Modular Testing The modular test was developed for the purpose of testing the <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> system from 0-10m. This test was performed in the CU RECUV lab, with truth data acquired using a system of VICON cameras.</li>
<li>100m Testing The 100m test was developed for the purpose of testing the system across the full 0-100m required range. This test was performed at the Boulder airport, using a test rig based on attaching CubeSats to a car, and acquiring truth data by affixing a GPS Trimble system to the car.</li>
</ol>
<h3>Running the Software Suite</h3>
<p><a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> has a main script for running the entire software suite, as well as test cases for utilizing only the post-processing portion of the code. </p><h4><a class="el" href="_v_a_n_t_a_g_e__main_8m.html" title="% The Signals ">VANTAGE_main.m</a></h4>
<p>Running VANTAGE_main executes everything involved in the full system, from transmitting a Manifest.json file to <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a>, executing data capture, and performing post-processing. See below for a description of the avionics, communications, and how to configure the first portion of the code for a different avionics setup.</p>
<h4>Post-processing</h4>
<p>To perform only post-processing on an existing data set, utilize +VANTAGE/+Test/+PostProcessing/Test_Fusion.m . This file utilizes a testing framework to attempt post-processing on a given data set. To configure this test case, modify the configDirecNames in the test case constructor to point to the config directories of the corresponding test types. Additionally modify <em>testType</em> to define the type of the three tests that you wish to process. This can be set to any of the cases in the switch statement below.</p>
<p>When run, the program will detect the relevant files based on the configuration file, and sequentially process the TOF data, then the optical data. See the UML diagrams in the <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> PFR data package for specifics on the workings of the software algorithms.</p>
<h3>Data Directory</h3>
<p>The organization of the data directory (<em>VANTAGE/Data/</em>) is crucial for the successful operation of the <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> software suite. The majority of errors that will be encountered when running the suite will be due to incorrectly configured data folders. The data directory is currently configured to handle the three types of tests used in the 2018-2019 development cycle. To ensure the correct configuration of the data:</p>
<p>Create a folder <em>Data/</em> within the main <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> folder. This is excluded by .git in the .gitignore, so all data to be processed will downloaded and stored individually on your local machine. When the software suite has been fully set up and run, the Data directory will have the following folders: Simulation/ truthMats/ Results/ ErrorOut/ ModularTest_4_9/ 3_25_100m/</p>
<p>These should contain the following: </p><h4>Simulation/</h4>
<p>The simulation folder will have subfolders describing the type, date, and speed of the test. An example of this is: <em>Simulation_4_15_030</em>, which represents a test taken on April 15, at 0.30m/s. Within each of these subdirectories should be two folders, <em>Optical/</em> and <em>TOF/</em>. It will also have a <em>truth.json</em> file, and a <em>truth_corrected.json</em>, which is the truth file <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> will process. In the case of the simulation, optical data should have naming conventions of a prefix <em>VTube</em>, and a timestamp suffix. If using the <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> simulation software suite, this convention will automaticall be generated in the output. The TOF data should have multiple samples (taken with randomized noise), so it will have subdirectories of convention <em>Sample</em>. These files will then be prefixed with <em>Sample</em>, and suffixed with a timestamp and frame stamp.</p>
<h4>ModularTest_4_9/ &amp; 3_25_100m/</h4>
<p>This folder should have subfolders corresponding to a test number taken on that day (e.g. <em>Test5/</em>). This will then follow the general structure of a folder <em>Optical/</em>, <em>TOF/</em>, <em>truth.json</em>, and <em>truth_corrected.json</em>.</p>
<p>Optical images within the <em>Optical/</em> folder should be defined by the format <em>VANTAGEOPYYYYM_DD_HH_MM_SS_mmm.png</em> TOF pointclouds within the <em>TOF/</em> folder should be defined by the format <em>pointcloud_YYYY_MM_DD_HH_MM_SS.mmmmmm.pcd</em></p>
<h2>Configs</h2>
<p>There are folders corresponding to each of the three tests used by <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a>, configured as <em>3_25_100m</em>, <em>ModularTest_4_9</em>, and <em>Simulation</em>. Within each of these folders will be subdirectories corresponding to individual tests run on those dates.</p><ol type="1">
<li>Modular Sample folder: <em>Test5/</em></li>
<li>100m Sample folder: <em>Test5/</em></li>
<li>Simulation Sample folder: *_030/Sample1* (for 0.30m/s) Each of these folders will then contain configuration files, as described below: <h3>Deployer.json</h3>
</li>
</ol>
<p>VANTAGE_ROT: [Yaw, Pitch, Roll] euler angles of the deployer from its initial configuration [rad]</p>
<p>PHI, XI, NABLA, RHO, P_OPTICAL, D_TOF: Sensor location parameterization variables. After moving the deployer origin to the correct position in the global coordinate frame, then move the deployer origin from the centerline to the VCF origin according to these parameters defined in 13-5 [cm]</p>
<p>MU, BETA, SIGMA, PSI, GAMMA, L: Deployer parameterization variables defined in 13-5 [cm]</p>
<p>TUBE_ORIGIN_COEFFS: Deployer tube origins are relative to deployer origin. Each tube contains the coefficients of the deployer parameterization variables needed to locate the tube origin. The order of the variables in each coefficient array is given as:</p>
<p>x ~ [PSI, GAMMA]</p>
<p>y ~ [MU]</p>
<p>z ~ [L]</p>
<p>CAMERA_LOC: camera location in X,Y,Z relative to the <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> frame's origin [cm]</p>
<p>CAMERA_ROT: camera rotation H,P,B [rad]</p>
<p>FOCAL_LENGTH: Focal length in [mm]</p>
<p>APERTURE: Aperture [mm] - this is the physical sensor diameter (for a rectangular sensor)</p>
<p>H_FOV: horizontal field of view [deg]</p>
<p>V_FOV: vertical field of view [deg]</p>
<p>X_Res: horizontal resolution [Pixel]</p>
<p>Y_Res: vertical resolution [Pixel]</p>
<p>Focus: Focus position (where you actually focus) [mm]</p>
<h3>Manifest.json</h3>
<p>This is a sample of the file that would be delivered to the <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> system by an operator of the NanoRacks deployer. It contains descriptions of the cubesats to be deployed as well as deployment geometry. It also contains the expected release time of the cubesats. Additionally, it should contain a filepath to the truth data json and the test scenario.</p>
<p>DeploymentTube: tube number from which cubesats are expected to deploy.</p>
<p>VantageTube: tube that is occupied by <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> system.</p>
<p>expectedRelease: datetime array containing expected release time.</p>
<p>CubesatArray: array containing data for each cubesat to be deployed.</p>
<p>name: cubesat name.</p>
<p>rangeOrder: order in which this cubesat will exit the tube.</p>
<p>expectedU: expected cubesat size in U.</p>
<p>actualDims: the actual dimensions of the cubesat in meters.</p>
<p>TruthDataFile: filepath to truth data file (.json).</p>
<p>testScenario: test scenario being run ('modular', '100m', or 'simulation')</p>
<h3>Optical.json</h3>
<p>OpticalData: Directory pointing to optical images for current test</p>
<p>OpticalFileExtension: Prefix for optical image files</p>
<p>DesiredFPS: Deprecated variable for processing at a specific FPS other than sensor parameter</p>
<p>PlotBinarizedImages: Boolean for plotting images after adaptive binarization</p>
<p>PlotCentroids: Boolean for plotting centroids of objects on binarized images</p>
<p>PlotHist: Boolean for plotting visual magnitude histogram of current image</p>
<p>PlotAny: Boolean for setting on/off for plotting anything in optical processing</p>
<p>PlotCubeSats: Boolean for plotting grayscale image</p>
<p>PlotIBoundaries: Boolean for plotting boundaries on grayscale image</p>
<p>RunOcclusion: Boolean for attempting optical occlusion processing</p>
<p>PerformDataCleaning: Boolean for setting data to 0 manually as defined in 'Clean100m' and 'CleanModular'</p>
<p>Clean100m: Pixel regions for manual data processing (100m test)</p>
<p>CleanModular: Pixel regions for manual data processing (Modular test) </p><h3>Sensors.json</h3>
<p>TOFData: Directory pointing to pointclouds for current test</p>
<p>OpticalFocalLength: Focal length of optical camera (m)</p>
<p>OpticalPixelSize: Pixel width of optical camera (m)</p>
<p>OpticalResolution: (width,height) (pixels)</p>
<h3>TOF.json</h3>
<p>maxAllowableRange: Range at which to stop using data from the TOF camera (m)</p>
<p>ptMaxDistanceFromPlane: Maximum distance of any given point from a plane to be considered part of the plane (m)</p>
<p>fps: Nominal fps of the TOF camera</p>
<p>HVfov_deg: [horizontal-TOF-field-of-view vertical-TOF-field-of-view] (deg)</p>
<h3>Transform.json</h3>
<p>V_TCF2VCF: 3D vector from origin of TOF Cartesian Frame (TCF) to <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> Cartesian Frame (VCF)</p>
<p>VT_DCM: 3x3 orthonormal transform matrix from TCF to VCF such that v_VCF = VT_DCM * v_TCF</p>
<p>V_CCF2VCF: 3D vector from origin of Camera Cartesian Frame (CCF) to <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> Cartesian Frame (VCF)</p>
<p>VC_DCM: 3x3 orthonormal transform matrix from CCF to VCF such that v_VCF = VC_DCM * v_CCF</p>
<h3>Validate.json</h3>
<p>CorrelateTruthData: Whether to perform truth data corrections/timestamp alignment ComputingResults: Deprecated - whether to perform results processing</p>
<h2>Tools</h2>
<p>Miscellaneous tools can be found in the <a href="https://github.com/DylanBossie-CU/VANTAGE/tree/master/MiscTools">MiscTools</a> directory. </p><h3>tofCropping</h3>
<h3>PlotCubeSats</h3>
<p>This tool is used to generate 3D scatter plots of the first CubeSat launched for a given test type. Output figures will then be saved to <em>FigureOut/</em>. The script is currently configured to plot for three specific tests:</p><ol type="1">
<li>Simulation Test (4-15 0.85m/s)</li>
<li>Modular Test (4-9)</li>
<li>100m Test (3-25)</li>
</ol>
<p>To configure which test is run, modify <em>testType (line 4)</em> to match one of the switch cases.</p>
<h3>truthCorrections_matGenerator</h3>
<p>This tool is used to update the output <em>dataStruct</em> truth variable created in <em><a class="el" href="_validate_8m.html">Validate.m</a> (line 467)</em> to .mat files to cooperate with the <em>VANTAGE.masterPlotter()</em> function. It will search for each of the three types of test cases in the <em>VANTAGE/Data/</em> directory, and create a <em>dataStruct</em> .mat variable which contains truth data for later processing. To utilize this script, define the correct data directories in the beginning of the file which points to the location of the corrected truth data files.</p>
<h3>PlotTOFPointClouds</h3>
<p>This uses the built in <em>pcshow()</em> function in MATLAB to display raw pointcloud files. To utilize this script, define a directory which contains point clouds, and define the correct suffix in the <em>PointClouds</em> variable in line 13.</p>
<h3>RewriteDataStructVelocity</h3>
<p>This script reads dataStruct output files, and transposes the velocity vector as needed to be processed in <em>masterPlotter()</em>.</p>
<h3>TimeManager</h3>
<p>This uses date vectors and date strings to extract the time from a given TOF or Optical image filename and convert it to a global internal <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> Time (number of seconds past first TOF file time), using the method <em>VantageTime()</em>. The method <em>VantageTime2DateStr()</em> can be used to convert <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> Times to consistent human-readable date strings.</p>
<h3>TOFProcessing</h3>
<p>The TOF class's method, <em>TOFProcessing()</em> is a one-stop-shop for running the entire TOF suite. In its default configuration it receives <em>SensorData</em> which contains information about where TOF point cloud files are housed as well as a <em>Deployer</em> instance. It will proceed to identify CubeSats and their centroids in each point cloud, associate the centroids from frame to frame, and finally save all centroids to their respective <em>CubeSat*s. It also produces *TOFfit_VCF</em>, which is used by the <em>CubeSat</em> method <em>evalTofFit()</em> to evaluate the TOF's prediction of a <em>CubeSat</em>'s position at a given time.</p>
<h2>Automation</h2>
<p>Contains tools for getting data from sensors and communicating with Raspberry Pi for remote boot. </p><h3>OpticalCam_Automation</h3>
<p>Contains three tools for the optical camera. Important settings to mess with here: exposure time(associated with the ueye.is_Exposure command) and the sensor gain (for brighter images with more noise, is_SetHardwareGain command) </p><h4>Optical_Data_Capture.py</h4>
<p>This file is used for data collection during testing. Set up to take many images at a specified interval.</p>
<h4>Optical_Single_Frame.py</h4>
<p>This file is used for capturing single frames, primarily for use in performing sensor calibrations when data needs to be taken on command. This script is called from the calibration Matlab script.</p>
<h4>SimpleLive_Pyueye_OpenCV.py</h4>
<p>Used to see a live view of the optical camera output. Useful for performing alignments, can also be useful for camera calibrations and for showing off at Symposium/Expo</p>
<h3>TOF_Automation</h3>
<p>This directory contains all of the drivers and stuff for ToF. All of the scripts you need to run are in the  subdirectory Listed below are the important ones.</p>
<h4>TOF_Data_Capture.py</h4>
<p>Main testing script, takes a certain number of frames.</p>
<h4>image_viewer_orig.py</h4>
<p>Live views of the ToF camera.</p>
<h4>TOF_Single_Frame_Capture.py</h4>
<p>Captures Single frame of the ToF camera's "intensity" image. This is like a normal optical image that can be used for calibration.</p>
<h4>create_application.py</h4>
<p>The ToF camera runs on an application where certain parameters are set. See the ToF manual to understand what all the parameters mean.</p>
<h3>PiComms</h3>
<h3>main.m</h3>
<p>Main wrapper without the automation or post processing code. The MAC Address that the sockets are opened in is the address of the external computer that <a class="el" href="namespace_v_a_n_t_a_g_e.html">VANTAGE</a> is connected to, or the Raspberry Pi if the Raspberry Pi is still desired.</p>
<h3>socket_vantage.py</h3>
<p>The code running on the Raspberry Pi. If the code is ran on the external computer that simulates NanoRacks, the Pi can be bypassed completely. Synchronizes with the main script, sends a manifest and receives the results from Vantage. MAC address the sockets are bound to is the address of the Ethernet port of the external computer. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon May 6 2019 04:41:41 for VANTAGE Software by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
